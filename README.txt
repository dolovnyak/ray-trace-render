переменная light_source в функции get_intersect_shadows может быть убрана для оптимизации, если не нужно физическое представление источника света.
цвет для объектов с light_source = 1, нужно задавать с огромными значениями, чтобы коэфициенты от света не уменьшали их яркость меньше 255.
min_distance и max_distance, которые передаются через структуру канваса, на самом деле являются ограничителями коэфициентов, на которые умножается вектор и таким образом получается расстояние, а не самим растоянием.
